<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Advanced Employee Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-blue-100 min-h-screen p-6">
    <div class="flex h-screen">
<!-- Include Sidebar Fragment -->
<div th:replace="usersidebar :: userSidebarFragment"></div>



<div class="max-w-6xl mx-auto bg-white rounded-2xl shadow-lg p-10">
             
        <!-- Header -->
        <div class="flex justify-between items-center mb-8">
            <h1 class="text-4xl font-bold">Employee Dashboard</h1>

        </div>

        <!-- Profile Section -->
    <!-- Profile Section (User Login Info) -->
    <div class="bg-green-50 p-6 rounded-xl mb-8 flex items-center space-x-6 shadow-md hidden" id="profileSection">
        <img alt="Profile Picture" class="rounded-full" src="https://via.placeholder.com/80">
        <div>
            <h2 class="text-2xl font-bold" id="userName"></h2>
            <p class="text-gray-600" id="userRole"></p>
            <p class="text-gray-500 text-sm" id="userId"></p>
        </div>
    </div>


    <!-- Actions Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- View Profile -->
            <div class="bg-white border hover:border-green-400 p-6 rounded-2xl shadow-md flex flex-col items-center text-center hover:shadow-lg transition">
                <div class="text-green-500 text-4xl mb-4">üë§</div>
                <h3 class="text-xl font-bold mb-2">View Profile</h3>
                <p class="text-gray-600 mb-4">See your personal and job details.</p>
                <button class="mt-auto bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full">
                    View
                </button>
            </div>

            <!-- Submit Leave Application -->
            <div class="bg-white border hover:border-green-400 p-6 rounded-2xl shadow-md flex flex-col items-center text-center hover:shadow-lg transition">
                <div class="text-green-500 text-4xl mb-4">üìù</div>
                <h3 class="text-xl font-bold mb-2">Leave Application</h3>
                <p class="text-gray-600 mb-4">Apply for vacation or sick leaves.</p>
                <button class="mt-auto bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full">
                    Apply
                </button>
            </div>

            <!-- Update Personal Documents -->
            <div class="bg-white border hover:border-green-400 p-6 rounded-2xl shadow-md flex flex-col items-center text-center hover:shadow-lg transition">
                <div class="text-green-500 text-4xl mb-4">üìÑ</div>
                <h3 class="text-xl font-bold mb-2">Update Documents</h3>
                <p class="text-gray-600 mb-4">Upload or modify your documents.</p>
                <button class="mt-auto bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full">
                    Update
                </button>
            </div>

            <!-- View Payslip -->
            <div class="bg-white border hover:border-green-400 p-6 rounded-2xl shadow-md flex flex-col items-center text-center hover:shadow-lg transition">
                <div class="text-green-500 text-4xl mb-4">üí∞</div>
                <h3 class="text-xl font-bold mb-2">View Payslip</h3>
                <p class="text-gray-600 mb-4">Check your monthly salary slips.</p>
                <button class="mt-auto bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full">
                    View
                </button>
            </div>
        </div>

    </div>
    </div>
<script>

  document.addEventListener("DOMContentLoaded", function () {
      const token = localStorage.getItem("token");
      console.log("Token:", token);

      fetch("http://localhost:8080/api/user/userdata", {
          method: "GET",
          headers: {
              "Authorization": "Bearer " + token,
              "Content-Type": "application/json"
          }
      })
      .then(response => {
          if (response.status === 401) {
              alert("Session expired. Please log in again.");
              window.location.href = "/user-login";
              return;
          }
          if (!response.ok) {
              throw new Error("HTTP status " + response.status);
          }
          return response.json(); // <- Only here do we parse JSON
      })
      .then(data => {
          console.log("User data:", data);

          const profileSection = document.getElementById("profileSection");
          profileSection.classList.remove("hidden");

          document.getElementById("userName").textContent = data.username || "N/A";
          document.getElementById("userRole").textContent = data.role || "N/A";
          document.getElementById("userId").textContent = "Employee ID: " + (data.id || "N/A");
      })
      .catch(error => {
          console.error("Error:", error);
      });

      // Logout button
      const logoutButton = document.querySelector("button");
      if (logoutButton) {
          logoutButton.addEventListener("click", function () {
              localStorage.removeItem("token");
              window.location.href = "/user-login";
          });
      }
  });

    </script>
</body>
</html>
