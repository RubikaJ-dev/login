<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HRMS Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex bg-green-100 h-screen font-sans">
<!-- Sidebar -->
<!-- Sidebar will be dynamically loaded here -->
<div th:replace="sidebar :: sidebarFragment"></div>

<!-- Main content -->
<main class="flex-1 p-6 min-h-screen">
  <!-- Add Employee Section -->
  <section class="bg-white p-6 rounded shadow-md w-full h-full mb-8">
    <h2 class="text-lg font-semibold mb-4">Add Employee</h2>
    <form id="employeeForm" enctype="multipart/form-data" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <div>
        <label for="name" class="block text-sm font-medium text-gray-700">Name</label>
        <input type="text" id="name" name="name" placeholder="Name" class="border p-2 rounded">
      </div>

      <div>
        <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
        <input type="text" id="email" name="email" placeholder="Email" class="border p-2 rounded">
      </div>

      <div>
        <label for="job_role" class="block text-sm font-medium text-gray-700">Designation</label>
        <input type="text" id="job_role" name="designation" placeholder="Designation" class="border p-2 rounded">
      </div>

      <div>
        <label for="age" class="block text-sm font-medium text-gray-700">Age</label>
        <input type="text" id="age" name="age" placeholder="Age" class="border p-2 rounded">
      </div>

      <div>
        <label for="department" class="block text-sm font-medium text-gray-700">Department</label>
        <input type="text" id="department" name="department" placeholder="Department" class="border p-2 rounded">
      </div>

      <div>
        <label for="date_of_birth" class="block text-sm font-medium text-gray-700">Date of Birth</label>
        <input type="date" id="date_of_birth" name="dateOfBirth" placeholder="DOB" class="border p-2 rounded">
      </div>

      <div>
        <label for="date_of_join" class="block text-sm font-medium text-gray-700">Date of Joining</label>
        <input type="date" id="date_of_join" name="dateOfJoin" placeholder="DOJ" class="border p-2 rounded">
      </div>

      <div>
        <label for="phone_number" class="block text-sm font-medium text-gray-700">Primary Phone</label>
        <input type="text" id="phone_number" name="primaryPhone" placeholder="Primary Phone" class="border p-2 rounded">
      </div>

      <div>
        <label for="secondary_phone_number" class="block text-sm font-medium text-gray-700">Secondary Phone</label>
        <input type="text" id="secondary_phone_number" name="secondaryPhone" placeholder="Secondary Phone" class="border p-2 rounded">
      </div>

      <div>
        <label for="address.street" class="block text-sm font-medium text-gray-700">Address</label>
        <input type="text" id="address.street" name="address" placeholder="Address" class="border p-2 rounded">
      </div>

      <div>
        <label for="address.city" class="block text-sm font-medium text-gray-700">City</label>
        <input type="text" id="address.city" name="city" placeholder="City" class="border p-2 rounded">
      </div>

      <div>
        <label for="address.state" class="block text-sm font-medium text-gray-700">State</label>
        <input type="text" id="address.state" name="state" placeholder="State" class="border p-2 rounded">
      </div>

      <div>
        <label for="degree.degree_name" class="block text-sm font-medium text-gray-700">Highest Degree</label>
        <input type="text" id="degree.degree_name" name="degree" placeholder="Highest Degree" class="border p-2 rounded">
      </div>

      <div>
        <label for="previousEmployment.company_name" class="block text-sm font-medium text-gray-700">Previous Company</label>
        <input type="text" id="previousEmployment.company_name" name="previousEmployment" placeholder="Company Name" class="border p-2 rounded">
      </div>

      <div>
        <label for="ctc" class="block text-sm font-medium text-gray-700">Current CTC</label>
        <input type="number" id="ctc" name="ctc" placeholder="Current CTC" class="border p-2 rounded">
      </div>

      <div>
        <label for="certificationPath" class="block text-sm font-medium text-gray-700">Certification</label>
        <input type="file" id="certificationPath" name="file" multiple accept=".pdf,.doc,.docx" class="border p-2 rounded">
      </div>

      <button type="submit" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded">Add Employee</button>
    </form>
  </section>
</main>

<script>
  // JavaScript to handle form submission using fetch
  document.getElementById("employeeForm").addEventListener("submit", function (e) {
    e.preventDefault(); // Prevent the form from submitting the usual way

    // Create a FormData object to send employee data and the file
    const formData = new FormData();

    formData.append("name", document.getElementById("name").value);
     formData.append("email", document.getElementById("email").value);
    formData.append("age", document.getElementById("age").value);
    formData.append("designation", document.getElementById("job_role").value);
    formData.append("department", document.getElementById("department").value);
    formData.append("dateOfBirth", document.getElementById("date_of_birth").value);
    formData.append("dateOfJoin", document.getElementById("date_of_join").value);
    formData.append("primaryPhone", document.getElementById("phone_number").value);
    formData.append("secondaryPhone", document.getElementById("secondary_phone_number").value);
    formData.append("address", document.getElementById("address.street").value);
    formData.append("city", document.getElementById("address.city").value);
    formData.append("state", document.getElementById("address.state").value);
    formData.append("degree", document.getElementById("degree.degree_name").value);
    formData.append("previousEmployment", document.getElementById("previousEmployment.company_name").value);
    formData.append("ctc", document.getElementById("ctc").value);
    formData.append("file", document.getElementById("certificationPath").files[0]); // Only appending the first file

    // Send the data using fetch
    fetch("/addEmployee", {
      method: "POST",
      body: formData
    })
    .then(response => {
      if (response.ok) {
        alert("Employee added successfully!");
        window.location.href = "/employee"; // Redirect to employee list page
      } else {
        alert("Failed to add employee.");
      }
    })
    .catch(error => {
      console.error("Error:", error);
      alert("An error occurred while adding the employee.");
    });
  });
</script>
</body>
</html>
